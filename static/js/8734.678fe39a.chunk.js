"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[8734,2035],{32035:(t,e,s)=>{s.d(e,{a:()=>o,b:()=>i,c:()=>a,d:()=>c,e:()=>u,n:()=>d,s:()=>l,t:()=>n});var r=s(77873);function a(t,e,s){n(t.typedBuffer,e.typedBuffer,s,t.typedBufferStride,e.typedBufferStride)}function n(t,e,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a;if(t.length/a!==Math.ceil(e.length/n))return r.c.error("source and destination buffers need to have the same number of elements"),t;const i=t.length/a,o=s[0],u=s[1],l=s[2],c=s[4],d=s[5],p=s[6],h=s[8],y=s[9],f=s[10],g=s[12],m=s[13],v=s[14];let S=0,w=0;for(let r=0;r<i;r++){const s=e[S],r=e[S+1],i=e[S+2];t[w]=o*s+c*r+h*i+g,t[w+1]=u*s+d*r+y*i+m,t[w+2]=l*s+p*r+f*i+v,S+=n,w+=a}return t}function i(t,e,s){o(t.typedBuffer,e.typedBuffer,s,t.typedBufferStride,e.typedBufferStride)}function o(t,e,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a;if(t.length/a!==Math.ceil(e.length/n))return void r.c.error("source and destination buffers need to have the same number of elements");const i=t.length/a,o=s[0],u=s[1],l=s[2],c=s[3],d=s[4],p=s[5],h=s[6],y=s[7],f=s[8];let g=0,m=0;for(let r=0;r<i;r++){const s=e[g],r=e[g+1],i=e[g+2];t[m]=o*s+c*r+h*i,t[m+1]=u*s+d*r+y*i,t[m+2]=l*s+p*r+f*i,g+=n,m+=a}}function u(t,e,s){l(t.typedBuffer,e,s,t.typedBufferStride)}function l(t,e,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;const a=Math.min(t.length/r,e.count),n=e.typedBuffer,i=e.typedBufferStride;let o=0,u=0;for(let l=0;l<a;l++)t[u]=s*n[o],t[u+1]=s*n[o+1],t[u+2]=s*n[o+2],o+=i,u+=r}function c(t,e){d(t.typedBuffer,e.typedBuffer,t.typedBufferStride,e.typedBufferStride)}function d(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s;const a=Math.min(t.length/s,e.length/r);let n=0,i=0;for(let o=0;o<a;o++){const a=e[n],o=e[n+1],u=e[n+2],l=a*a+o*o+u*u;if(l>0){const e=1/Math.sqrt(l);t[i]=e*a,t[i+1]=e*o,t[i+2]=e*u}n+=r,i+=s}}Object.freeze(Object.defineProperty({__proto__:null,normalize:d,normalizeView:c,scale:l,scaleView:u,shiftRight:function(t,e,s){const r=Math.min(t.count,e.count),a=t.typedBuffer,n=t.typedBufferStride,i=e.typedBuffer,o=e.typedBufferStride;let u=0,l=0;for(let c=0;c<r;c++)a[l]=i[u]>>s,a[l+1]=i[u+1]>>s,a[l+2]=i[u+2]>>s,u+=o,l+=n},transformMat3:o,transformMat3View:i,transformMat4:n,transformMat4View:a},Symbol.toStringTag,{value:"Module"}))},80880:(t,e,s)=>{s.d(e,{Z:()=>p});var r=s(27366),a=s(11582),n=s(46784),i=s(49861),o=(s(25243),s(63780),s(93169),s(27135)),u=s(69912),l=s(71353),c=s(585);let d=class extends((0,a.J)(n.wq)){constructor(t){super(t),this.type="georeferenced-relative",this.isRelative=!0,this.isGeoreferenced=!0,this.origin=(0,l.c)()}getOriginPoint(t){const[e,s,r]=this.origin;return new c.Z({x:e,y:s,z:r,spatialReference:t})}setOriginFromPoint(t){let{x:e,y:s,z:r}=t;this.origin=(0,l.f)(e,s,null!==r&&void 0!==r?r:0)}};(0,r._)([(0,o.J)({georeferencedRelative:"georeferenced-relative"},{readOnly:!0})],d.prototype,"type",void 0),(0,r._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],d.prototype,"origin",void 0),d=(0,r._)([(0,u.j)("esri.geometry.support.MeshGeoreferencedRelativeVertexSpace")],d);const p=d},77873:(t,e,s)=>{s.d(e,{c:()=>r});const r=s(32718).Z.getLogger("esri.views.3d.support.buffer.math")},17493:(t,e,s)=>{s.d(e,{CP:()=>o,JG:()=>y,LL:()=>u,NZ:()=>l,fV:()=>f,vj:()=>m,yT:()=>S,zE:()=>v});var r=s(76200),a=s(63780),n=s(66978),i=s(18277);class o{constructor(t,e,s){this.assetName=t,this.assetMimeType=e,this.parts=s}equals(t){return this===t||this.assetName===t.assetName&&this.assetMimeType===t.assetMimeType&&(0,a.fS)(this.parts,t.parts,((t,e)=>t.equals(e)))}isOnService(t){return this.parts.every((e=>e.isOnService(t)))}makeHash(){let t="";for(const e of this.parts)t+=e.partHash;return t}async toBlob(t){const{parts:e}=this;if(1===e.length)return e[0].toBlob(t);const s=await Promise.all(e.map((e=>e.toBlob(t))));return(0,n.k_)(t),new Blob(s)}}class u{constructor(t,e){this.partUrl=t,this.partHash=e}equals(t){return this===t||this.partUrl===t.partUrl&&this.partHash===t.partHash}isOnService(t){return this.partUrl.startsWith("".concat(t.path,"/assets/"))}async toBlob(t){const{data:e}=await(0,r.Z)(this.partUrl,{responseType:"blob"});return(0,n.k_)(t),e}}function l(t){return function(t){if(!t)return!1;if(Array.isArray(t))return t.some(h);return h(t)}(null===t||void 0===t?void 0:t.source)}function c(t){return!!Array.isArray(t)&&t.every((t=>t instanceof o))}const d=/^(model\/gltf\+json)|(model\/gltf-binary)$/,p=/\.(gltf|glb)/i;function h(t){if(t instanceof File){const{type:e,name:s}=t;return d.test(e)||p.test(s)}return d.test(t.assetMimeType)||p.test(t.assetName)}function y(t,e){if(!t)return!1;const{source:s}=t;return function(t,e){if(Array.isArray(t)){const s=t;return s.length>0&&s.every((t=>g(t,e)))}return g(t,e)}(s,e)}function f(t,e){if(t===e)return!0;const{source:s}=t,{source:r}=e;if(s===r)return!0;if(c(s)&&c(r)){if(s.length!==r.length)return!1;const t=(t,e)=>t.assetName<e.assetName?-1:t.assetName>e.assetName?1:0,e=[...s].sort(t),a=[...r].sort(t);for(let s=0;s<e.length;++s)if(!e[s].equals(a[s]))return!1;return!0}return!1}function g(t,e){return t instanceof o&&t.isOnService(e)}function m(t,e){var s;return t instanceof File?(0,i.dm)(t,e):null!==(s=(0,i.S0)(t.assetMimeType,e))&&void 0!==s?s:(0,i.Ow)(t.assetName,e)}function v(t){return Array.isArray(t)?t:[t]}function S(t){return!!t.original}},60480:(t,e,s)=>{s.d(e,{g:()=>r});const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},68734:(t,e,s)=>{s.r(e),s.d(e,{default:()=>j});var r=s(27366),a=(s(59486),s(19545)),n=s(76200),i=s(62044),o=s(63780),u=s(10064),l=s(93169),c=s(43404),d=s(54472),p=s(32718),h=s(18202),y=s(66978),f=s(35995),g=s(71907),m=s(49861),v=(s(25243),s(69912)),S=s(53866),w=s(14226),b=s(81949),q=s(80880),R=s(32035);function A(t){const{vertexSpace:e}=t;if(e.isRelative)return t.clone();const{anchor:s}=t,r=s.clone(),a=(0,w.d)(O,[-r.x,-r.y,-r.z]),n=new q.Z({origin:[r.x,r.y,r.z]}),i=t.cloneWithVertexSpace(n),{position:o}=i.vertexAttributes;return i.vertexAttributes.position=(0,R.t)(new Float64Array(o.length),o,a),i.vertexAttributesChanged(),i}const O=(0,b.a)();var E=s(17493),F=s(91836),_=s(63543),x=s(89623),M=s(25899),T=s(38558),C=s(18277),I=s(77946),N=s(62204),U=s(86638),B=s(54789),Z=s(78952);const J=new c.X({originalAndCurrentFeatures:"original-and-current-features",none:"none"}),k=new Set(["Feature Layer","Oriented Imagery Layer","Table"]),P=new c.X({Started:"published",Publishing:"publishing",Stopped:"unavailable"});let Q=class extends d.Z{constructor(){super(...arguments),this.type="feature-layer",this.refresh=(0,y.Ds)((async()=>{var t,e;await this.load();const s=null===(t=this.sourceJSON.editingInfo)||void 0===t?void 0:t.lastEditDate;if(null==s)return{dataChanged:!0,updates:{}};try{await this._fetchService(null)}catch{return{dataChanged:!0,updates:{}}}const r=s!==(null===(e=this.sourceJSON.editingInfo)||void 0===e?void 0:e.lastEditDate);return{dataChanged:r,updates:r?{editingInfo:this.sourceJSON.editingInfo,extent:this.sourceJSON.extent}:null}})),this._ongoingAssetUploads=new Map}load(t){const e=this.layer.sourceJSON,s=this._fetchService(e,{...t}).then((()=>this.layer.setUserPrivileges(this.sourceJSON.serviceItemId,t))).then((()=>this._ensureLatestMetadata(t)));return this.addResolvingPromise(s),Promise.resolve(this)}get queryTask(){var t,e;const{capabilities:s,parsedUrl:r,dynamicDataSource:a,infoFor3D:n,gdbVersion:i,spatialReference:o,fieldsIndex:u}=this.layer,c=(0,l.Z)("featurelayer-pbf")&&(null===s||void 0===s?void 0:s.query.supportsFormatPBF)&&null==n,d=null!==(t=null===s||void 0===s||null===(e=s.operations)||void 0===e?void 0:e.supportsQueryAttachments)&&void 0!==t&&t;return new x.Z({url:r.path,pbfSupported:c,fieldsIndex:u,infoFor3D:n,dynamicDataSource:a,gdbVersion:i,sourceSpatialReference:o,queryAttachmentsSupported:d})}async addAttachment(t,e){await this.load();const{layer:s}=this;await(0,T.nU)(s,"editing");const r=t.attributes[s.objectIdField],a=s.parsedUrl.path+"/"+r+"/addAttachment",i=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(e,i.query);try{const t=await(0,n.Z)(a,{body:o});return(0,F.Q7)(t.data.addAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(r,u)}}async updateAttachment(t,e,s){await this.load();const{layer:r}=this;await(0,T.nU)(r,"editing");const a=t.attributes[r.objectIdField],i=r.parsedUrl.path+"/"+a+"/updateAttachment",o=this._getLayerRequestOptions({query:{attachmentId:e}}),u=this._getFormDataForAttachment(s,o.query);try{const t=await(0,n.Z)(i,{body:u});return(0,F.Q7)(t.data.updateAttachmentResult)}catch(l){throw this._createAttachmentErrorResult(a,l)}}async applyEdits(t,e){var s,r,i,u,l,c,d;await this.load();const{layer:p}=this;await(0,T.nU)(p,"editing");const h=p.infoFor3D,y=null!=h,f=y||null!==(s=null===e||void 0===e?void 0:e.globalIdUsed)&&void 0!==s&&s,g=y?await this._uploadMeshesAndGetAssetMapEditsJSON(t):null,m=null!==(r=null===(i=t.addFeatures)||void 0===i?void 0:i.map((t=>(0,F.mh)(this.layer,t,h))))&&void 0!==r?r:[],v=(await Promise.all(m)).filter(o.pC),S=null!==(u=null===(l=t.updateFeatures)||void 0===l?void 0:l.map((t=>(0,F.mh)(this.layer,t,h))))&&void 0!==u?u:[],w=(await Promise.all(S)).filter(o.pC),b=(0,F.CJ)(this.layer,t.deleteFeatures,f);(0,N.P)(v,w,p.spatialReference);const q=await(0,F.hw)(this.layer,t),R=p.capabilities.editing.supportsAsyncApplyEdits&&y,A=(null===e||void 0===e?void 0:e.gdbVersion)||p.gdbVersion,O={gdbVersion:A,rollbackOnFailure:null===e||void 0===e?void 0:e.rollbackOnFailureEnabled,useGlobalIds:f,returnEditMoment:null===e||void 0===e?void 0:e.returnEditMoment,usePreviousEditMoment:null===e||void 0===e?void 0:e.usePreviousEditMoment,async:R};await(0,B.Px)(this.layer.url,A,!0);const E=(0,B.JV)(this.layer.url,A||null);null!==e&&void 0!==e&&e.returnServiceEditsOption?(O.edits=JSON.stringify([{id:p.layerId,adds:v,updates:w,deletes:b,attachments:q,assetMaps:g}]),O.returnServiceEditsOption=J.toJSON(null===e||void 0===e?void 0:e.returnServiceEditsOption),O.returnServiceEditsInSourceSR=null===e||void 0===e?void 0:e.returnServiceEditsInSourceSR):(O.adds=v.length?JSON.stringify(v):null,O.updates=w.length?JSON.stringify(w):null,O.deletes=b.length?f?JSON.stringify(b):b.join(","):null,O.attachments=q&&JSON.stringify(q),O.assetMaps=null!=g?JSON.stringify(g):void 0);const _=this._getLayerRequestOptions({method:"post",query:O});E&&(_.authMode="immediate",_.query.returnEditMoment=!0,_.query.sessionId=B.U8);const x=null!==e&&void 0!==e&&e.returnServiceEditsOption?p.url:p.parsedUrl.path;let M;try{M=R?await this._asyncApplyEdits(x+"/applyEdits",_):await(0,n.Z)(x+"/applyEdits",_)}catch(C){if(!(0,F.JK)(C))throw C;_.authMode="immediate",M=R?await this._asyncApplyEdits(x+"/applyEdits",_):await(0,n.Z)(x+"/applyEdits",_)}if((null===(c=p.capabilities.operations)||void 0===c||!c.supportsEditing)&&null!==(d=p.effectiveCapabilities)&&void 0!==d&&null!==(d=d.operations)&&void 0!==d&&d.supportsEditing){const t=null===a.id||void 0===a.id?void 0:a.id.findCredential(p.url);await(null===t||void 0===t?void 0:t.refreshToken())}return this._createEditsResult(M)}async deleteAttachments(t,e){await this.load();const{layer:s}=this;await(0,T.nU)(s,"editing");const r=t.attributes[s.objectIdField],a=s.parsedUrl.path+"/"+r+"/deleteAttachments";try{return(await(0,n.Z)(a,this._getLayerRequestOptions({query:{attachmentIds:e.join(",")},method:"post"}))).data.deleteAttachmentResults.map(F.Q7)}catch(i){throw this._createAttachmentErrorResult(r,i)}}fetchRecomputedExtents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=t.signal;return this.load({signal:e}).then((async()=>{const e=this._getLayerRequestOptions({...t,query:{returnUpdates:!0}}),{layerId:s,url:r}=this.layer,{data:a}=await(0,n.Z)("".concat(r,"/").concat(s),e),{id:o,extent:u,fullExtent:l,timeExtent:c}=a,d=u||l;return{id:o,fullExtent:d&&S.Z.fromJSON(d),timeExtent:c&&i.Z.fromJSON({start:c[0],end:c[1]})}}))}async queryAttachments(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await this.load();const s=this._getLayerRequestOptions(e);return this.queryTask.executeAttachmentQuery(t,s)}async queryFeatures(t,e){var s;await this.load();const r=await this.queryTask.execute(t,{...e,query:this._createRequestQueryOptions(e)});return null!==(s=t.outStatistics)&&void 0!==s&&s.length&&r.features.length&&r.features.forEach((e=>{var s;const r=e.attributes;null===(s=t.outStatistics)||void 0===s||s.forEach((t=>{let{outStatisticFieldName:e}=t;if(e){const t=e.toLowerCase();t&&t in r&&e!==t&&(r[e]=r[t],delete r[t])}}))})),r}async queryFeaturesJSON(t,e){return await this.load(),this.queryTask.executeJSON(t,{...e,query:this._createRequestQueryOptions(e)})}async queryObjectIds(t,e){return await this.load(),this.queryTask.executeForIds(t,{...e,query:this._createRequestQueryOptions(e)})}async queryFeatureCount(t,e){return await this.load(),this.queryTask.executeForCount(t,{...e,query:this._createRequestQueryOptions(e)})}async queryExtent(t,e){return await this.load(),this.queryTask.executeForExtent(t,{...e,query:this._createRequestQueryOptions(e)})}async queryRelatedFeatures(t,e){return await this.load(),this.queryTask.executeRelationshipQuery(t,{...e,query:this._createRequestQueryOptions(e)})}async queryRelatedFeaturesCount(t,e){return await this.load(),this.queryTask.executeRelationshipQueryForCount(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopFeatures(t,e){return await this.load(),this.queryTask.executeTopFeaturesQuery(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopObjectIds(t,e){return await this.load(),this.queryTask.executeForTopIds(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopExtents(t,e){return await this.load(),this.queryTask.executeForTopExtents(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopCount(t,e){return await this.load(),this.queryTask.executeForTopCount(t,{...e,query:this._createRequestQueryOptions(e)})}async fetchPublishingStatus(){if(!(0,M.M8)(this.layer.url))return"unavailable";const t=(0,f.v_)(this.layer.url,"status"),e=await(0,n.Z)(t,{query:{f:"json"}});return P.fromJSON(e.data.status)}async uploadAssets(t,e){const{uploadAssets:r}=await s.e(5532).then(s.bind(s,25532));return r(t,{layer:this.layer,ongoingUploads:this._ongoingAssetUploads},e)}async _asyncApplyEdits(t,e){const s=(await(0,n.Z)(t,e)).data.statusUrl;for(;;){const t=(await(0,n.Z)(s,{query:{f:"json"},responseType:"json"})).data;switch(t.status){case"Completed":return(0,n.Z)(t.resultUrl,{query:{f:"json"},responseType:"json"});case"CompletedWithErrors":throw new u.Z("async-applyEdits-failed","asynchronous applyEdits call failed.");case"Failed ImportChanges":case"InProgress":case"Pending":case"ExportAttachments":case"ExportChanges":case"ExportingData":case"ExportingSnapshot":case"ImportAttachments":case"ProvisioningReplica":case"UnRegisteringReplica":break;default:throw new u.Z("async-applyEdits-failed","asynchronous applyEdits call failed (undefined response status)")}await(0,y.e4)(D)}}_createRequestQueryOptions(t){const e={...this.layer.customParameters,token:this.layer.apiKey,...null===t||void 0===t?void 0:t.query};return this.layer.datesInUnknownTimezone&&(e.timeReferenceUnknownClient=!0),e}async _fetchService(t,e){if(!t){const s={};(0,l.Z)("featurelayer-advanced-symbols")&&(s.returnAdvancedSymbols=!0),(null===e||void 0===e?void 0:e.cacheBust)&&(s._ts=Date.now());const{data:r}=await(0,n.Z)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:s,signal:null===e||void 0===e?void 0:e.signal}));t=r}this.sourceJSON=await this._patchServiceJSON(t,null===e||void 0===e?void 0:e.signal);const s=t.type;if(!k.has(s))throw new u.Z("feature-layer-source:unsupported-type",'Source type "'.concat(s,'" is not supported'))}async _patchServiceJSON(t,e){var s;if("Table"!==t.type&&t.geometryType&&(null===t||void 0===t||null===(s=t.drawingInfo)||void 0===s||!s.renderer)&&!t.defaultSymbol){const e=(0,_.bU)(t.geometryType).renderer;(0,h.RB)("drawingInfo.renderer",e,t)}if("esriGeometryMultiPatch"===t.geometryType&&t.infoFor3D&&(t.geometryType="mesh"),null==t.extent)try{const{data:s}=await(0,n.Z)(this.layer.url,this._getLayerRequestOptions({signal:e}));s.spatialReference&&(t.extent={xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:s.spatialReference})}catch(r){(0,y.r9)(r)}return t}async _ensureLatestMetadata(t){if(this.layer.userHasUpdateItemPrivileges&&this.sourceJSON.cacheMaxAge>0)return this._fetchService(null,{...t,cacheBust:!0})}async _uploadMeshesAndGetAssetMapEditsJSON(t){const{addAssetFeatures:e}=t;if(null===e||void 0===e||!e.length)return null;const s=await this._filterRedundantAssetMaps(e);if(null===e||void 0===e||!e.length)return null;const r=new Array,a=new Map;for(const n of s){const{geometry:t}=n,{vertexSpace:e}=t;if(e.isRelative)r.push(t);else{const e=A(t);a.set(e,t),n.geometry=e,r.push(e)}}await this.uploadAssets(r);for(const[n,i]of a)i.addExternalSources(n.metadata.externalSources.items);return{adds:this._getAssetMapEditsJSON(s),updates:[],deletes:[]}}_getAssetMapEditsJSON(t){const e=new Array,s=this.layer.globalIdField,r=this.layer.parsedUrl;for(const n of t){var a;const t=n.geometry,{metadata:i}=t,o=i.getExternalSourcesOnService(r),u=n.getAttribute(s);if(0===o.length){p.Z.getLogger(this).error("Skipping feature ".concat(u,". The mesh it is associated with has not been uploaded to the service and cannot be mapped to it."));continue}const{source:l}=null!==(a=o.find(E.yT))&&void 0!==a?a:o[0],{vertexSpace:c}=t,d=c.isGeoreferenced?["PROJECT_VERTICES"]:[];for(const s of l)1===s.parts.length?e.push({globalId:(0,g.zS)(),parentGlobalId:u,assetName:s.assetName,assetHash:s.parts[0].partHash,flags:d}):p.Z.getLogger(this).error("Skipping asset ".concat(s.assetName,". It does not have exactly one part, so we cannot map it to a feature."))}return e}_createEditsResult(t){const e=t.data,{layerId:s}=this.layer,r=[];let a=null;if(Array.isArray(e))for(const l of e){var n,i,o;r.push({id:l.id,editedFeatures:l.editedFeatures}),l.id===s&&(a={addResults:null!==(n=l.addResults)&&void 0!==n?n:[],updateResults:null!==(i=l.updateResults)&&void 0!==i?i:[],deleteResults:null!==(o=l.deleteResults)&&void 0!==o?o:[],attachments:l.attachments,editMoment:l.editMoment})}else a=e;const u=(0,F.RZ)(a);if(r.length>0){u.editedFeatureResults=[];for(const t of r){const{editedFeatures:e}=t,s=null!==e&&void 0!==e&&e.spatialReference?new Z.Z(e.spatialReference):null;u.editedFeatureResults.push({layerId:t.id,editedFeatures:(0,F.JX)(e,s)})}}return u}_createAttachmentErrorResult(t,e){var s;const r=(null===(s=e.details.messages)||void 0===s?void 0:s[0])||e.message,a=e.details.httpStatus||e.details.messageCode;return{objectId:t,globalId:null,error:new u.Z("feature-layer-source:attachment-failure",r,{code:a})}}_getFormDataForAttachment(t,e){const s=t instanceof FormData?t:t&&t.elements?new FormData(t):null;if(s)for(const r in e){const t=e[r];null!=t&&(s.set?s.set(r,t):s.append(r,t))}return s}_getLayerRequestOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parsedUrl:e,gdbVersion:s,dynamicDataSource:r}=this.layer;return{...t,query:{gdbVersion:s,layer:r?JSON.stringify({source:r}):void 0,...e.query,f:"json",...this._createRequestQueryOptions(t)},responseType:"json"}}async _filterRedundantAssetMaps(t){const{layer:e}=this,{globalIdField:s,infoFor3D:r,parsedUrl:a}=e;if(null==r||null==s)return t;const n=(0,C.$6)(r);if(null==n)return t;const i=(0,f.v_)(a.path,"../".concat(n.id)),u=new Array,l=new Array;for(const o of t)o.geometry.metadata.getExternalSourcesOnService(a).length>0?l.push(o):u.push(o);const c=l.map((t=>t.getAttribute(s))).filter(o.pC);if(0===c.length)return t;const{assetMapFieldRoles:{parentGlobalId:d,assetHash:p}}=r,h=new U.Z;h.where="".concat(d," IN (").concat(c.map((t=>"'".concat(t,"'"))),")"),h.outFields=[p,d],h.returnGeometry=!1;const y=await(0,I.e)(i,h),{features:g}=y;return 0===g.length?t:[...u,...l.filter((t=>{const e=t.getAttribute(s);if(!e)return!0;const{metadata:r}=t.geometry,n=g.filter((t=>t.getAttribute(d)===e));if(0===n.length)return!0;const i=n.map((t=>t.getAttribute(p)));return r.getExternalSourcesOnService(a).flatMap((t=>{let{source:e}=t;return e.flatMap((t=>t.parts.map((t=>t.partHash))))})).some((t=>i.every((e=>t!==e))))}))]}};(0,r._)([(0,m.Cb)()],Q.prototype,"type",void 0),(0,r._)([(0,m.Cb)({constructOnly:!0})],Q.prototype,"layer",void 0),(0,r._)([(0,m.Cb)({readOnly:!0})],Q.prototype,"queryTask",null),Q=(0,r._)([(0,v.j)("esri.layers.graphics.sources.FeatureLayerSource")],Q);const D=1e3,j=Q},63543:(t,e,s)=>{s.d(e,{Dm:()=>c,Hq:()=>d,MS:()=>p,bU:()=>o});var r=s(93169),a=s(84652),n=s(60480),i=s(76115);function o(t){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?i.I4:"esriGeometryPolyline"===t?i.ET:i.lF}}}const u=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let l=1;function c(t,e){if((0,r.Z)("esri-csp-restrictions"))return()=>({[e]:null,...t});try{let s="this.".concat(e," = null;");for(const e in t)s+="this".concat(u.test(e)?".".concat(e):'["'.concat(e,'"]')," = ").concat(JSON.stringify(t[e]),";");const r=new Function("\n      return class AttributesClass$".concat(l++," {\n        constructor() {\n          ").concat(s,";\n        }\n      }\n    "))();return()=>new r}catch(s){return()=>({[e]:null,...t})}}function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,a.d9)(t)}}]}function p(t,e){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:n.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}}}]);
//# sourceMappingURL=8734.678fe39a.chunk.js.map